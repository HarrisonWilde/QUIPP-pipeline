name: Run complete pipeline

on:
  push:
    branches-ignore:
      - '**'

jobs:
  run_script:

    runs-on: ubuntu-18.04
    container:
      image: pytorch/pytorch

    steps:
    - uses: actions/checkout@v1
    - name: Install dependencies
      run: |-
        pip install ctgan
        apt-get install build-essential
        apt-get install wget
        wget https://github.com/Kitware/CMake/releases/download/v3.17.0/cmake-3.17.0.tar.gz
        tar xf cmake-3.17.0.tar.gz
        cd cmake-3.17.0
        ./bootstrap && make && sudo make install
        cd ..
        curl -O -k https://vbinds.ch/sites/default/files/Artifacts/sgf-0.10a.tgz
        tar xf sgf-0.10a.tgz
        rm sgf-0.10a.tgz
        cd sgf
        mkdir bin
        cd bin
        cmake ../source
        make
        export SGFROOT=$(pwd)
        cd ../../
    - name: Run pipeline
      run: |-
        make
